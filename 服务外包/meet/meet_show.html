<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" type="text/css" href="dist/layui/css/layui.css">
    <link rel="stylesheet" type="text/css" href="dist/me/css/meet_show.css">
    <link rel="stylesheet" type="text/css" href="dist/me/css/base.css">
    <script src="dist/me/js/jquery-3.3.1.js" type="text/javascript"></script>
    <script src="dist/layui/layui.js" type="text/javascript"></script>
    <script src="dist/me/js/vue.min.js" type="text/javascript"></script>
    <title>会议室详情介绍</title>
</head>

<form class="layui-form" action="" id="add_apply" style="display: none;margin: 20px 60px 0 15px">
    <div class="layui-form-item">
        <label class="layui-form-label">主题</label>
        <div class="layui-input-block">
            <input type="text" name="title"  lay-verify="required" placeholder="请输入标题" autocomplete="off" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">会议室</label>
        <div class="layui-input-inline open" data-method="notice"  >
            <input type="password" name="password" required lay-verify="required" placeholder="请选择会议室" autocomplete="off" class="layui-input">
        </div>

        <label class="layui-form-label">日期</label>
        <div class="layui-input-inline">
            <input type="text" id="day"  name="" required lay-verify="required" placeholder="请选择日期" autocomplete="off" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">开始时间</label>
        <div class="layui-input-inline">
            <input type="number" min="0" max="60"   step="1" name="" required lay-verify="required" placeholder="时钟" autocomplete="off" class="layui-input">
        </div>
        <div class="layui-input-inline">
            <input type="number" min="0" max="60"  step="15" name="" required lay-verify="required" placeholder="分钟" autocomplete="off" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">结束时间</label>
        <div class="layui-input-inline">
            <input type="number"  min="0" max="60"  step="1" name="" required lay-verify="required" placeholder="时钟" autocomplete="off" class="layui-input">
        </div>
        <div class="layui-input-inline">
            <input type="number"  min="0" max="60"  step="15" name="" required lay-verify="required" placeholder="分钟" autocomplete="off" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">人数</label>
        <div class="layui-input-block">
            <input type="text" name="title" required  lay-verify="required" placeholder="请输入标题" autocomplete="off" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">企业</label>
        <div class="layui-input-inline" >
            <select name="city" lay-verify="required" lay-filter="com" v-model="company">
                <option value="">公司</option>
                <option value="0" v-for="(item,i) in companys">{{item.city}}</option>
            </select>
        </div>
        <div class="layui-input-inline">
            <select name="city"  lay-verify="required" id="sections">
                <option value="" >部门</option>
                <!--<option value="0" v-for="(item,i) in sections">{{item.city}}</option>-->
            </select>
        </div>
    </div>
    <div class="layui-form-item layui-form-text">
        <label class="layui-form-label">会议介绍</label>
        <div class="layui-input-block">
            <textarea name="desc" placeholder="请输入内容" class="layui-textarea"></textarea>
        </div>
    </div>
    <div class="layui-form-item">
        <div class="layui-input-block">
            <button class="layui-btn" lay-submit lay-filter="formDemo">立即提交</button>
            <button type="reset" class="layui-btn layui-btn-primary">重置</button>
        </div>
    </div>
</form>

<body>
    <div class="goback">
        <a href="meetlist.html">返回会议室列表</a>
    </div>
    <div class="layui-container">
        <div class="layui-carousel" id="slider_img">
            <div carousel-item class="img_swiper">
                <img src="images/huiyi1.jpg">
                <img src="images/huiyi2.jpg">
                <img src="images/huiyi3.jpg">
                <img src="images/huiyi4.jpg">
            </div>
            <div class="img_describe">会议室一览</div>
        </div>
        <!-- 条目中可以是任意内容，如：<img src=""> -->
        <div class="pflags">
            <div class="pflag"><h5>50人</h5></div>
            <div class="pflag"><h5>配有WiFi</h5></div>
            <div class="pflag"><h5>4k超高清矩阵</h5></div>
            <div class="pflag"><h5>9个发表单元</h5></div>
            <div class="pflag"><h5>可投屏</h5></div>
        </div>
        <br>
        <div class="meet_describe">
            <p>
                中国领先的会议场地、活动资源在线预订平台。南京会议场地、南京会议酒店、南京年会场地
                、南京年会酒店、南京酒店会议室、南京酒店宴会厅、南京酒店会场预订，会议场地租赁，就上
                会小二，开会+住宿+用餐一站式会议服务平台，开启28分钟疾速场地直订服务，免费获3-6套会议
                报价方案，轻松搞定公司年会场地、培训会场地、发布会场地、研讨会场地、招商会场地、答谢
                会场地、经销商会议场地、工作总结会场地、沙龙/休闲会议场地。
            </p>
        </div>
        <div class="meet_apply">
            <div class="fl">
                <p class="fl">预计预定成功率：80%</p>
                <p class="fl" >累计预定次数：80次</p>
                <!--<a class="fl">查看该会议室近期预约</a>-->
            </div>
            <a class="fr" id="apply_now">立即预定</a>
        </div>

        <!--日历加表格显示预约情况-->

        <div class="calendar_table">
            <hr>
            <br>
            <div id="calender1" class="fl"></div>
            <div class="table_list fr">
                <table class="layui-hide" id="test" lay-filter="test"></table>

                <script type="text/html" id="toolbarDemo">
                    <div class="layui-btn-container">
                        <button class="layui-btn layui-btn-sm" lay-event="getCheckData">获取选中行数据</button>
                        <button class="layui-btn layui-btn-sm" lay-event="getCheckLength">获取选中数目</button>
                        <button class="layui-btn layui-btn-sm" lay-event="isAll">验证是否全选</button>
                    </div>
                </script>

                <script type="text/html" id="barDemo">
                    <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
                    <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
                </script>


            </div>
        </div>
    </div>

    <script>
        $('#apply_now').on('click', function () {
            console.log(1);
            layer.open({
                type: 1
                ,title: false //不显示标题栏
                // ,closeBtn: true
                ,title: ["发起预定",'font-size:16px;']
                ,area: ['720px','']
                ,shade: 0.8
                ,id: 'LAY_add_apply01' //设定一个id，防止重复弹出
                // ,btn: ['确定', '取消']
                ,btnAlign: 'c'
                ,moveType: 1 //拖拽模式，0或者1
                ,content: $('#add_apply')
                // ,success: function(layero){
                //     var btn = layero.find('.layui-layer-btn');
                //     btn.find('.layui-layer-btn0').attr({
                //         href: 'http://www.layui.com/'
                //         ,target: '_blank'
                //     });
                // }
            });
        });

        layui.use('table', function(){
            var table = layui.table;

            table.render({
                elem: '#test'
                ,url:'/test/table/demo1.json'
                // ,toolbar: '#toolbarDemo'
                ,title: '用户数据表'
                ,cols: [[
                    // {type: 'checkbox', fixed: 'left'}
                    ,{field:'username', title:'发起人', width:120, edit: 'text'}
                    ,{field:'email', title:'时间', width:150, sort: true ,edit: 'text', templet: function(res){
                            return '<em>'+ res.email +'</em>'
                        }}
                    ,{field:'sex', title:'地点', width:80, edit: 'text'}
                    ,{field:'city', title:'主题', width:100}
                    ,{field:'sign', title:'参加人数', sort: true}
                    ,{field:'detail', title:'查看', templet: function(res){
                            return '<a href="#">'+ res.email +'</a>'
                        }}
                    ,{fixed: 'right', title:'操作', toolbar: '#barDemo', width:150}
                ]]
                ,page: true
            });

            //头工具栏事件
            table.on('toolbar(test)', function(obj){
                var checkStatus = table.checkStatus(obj.config.id);
                switch(obj.event){
                    case 'getCheckData':
                        var data = checkStatus.data;
                        layer.alert(JSON.stringify(data));
                        break;
                    case 'getCheckLength':
                        var data = checkStatus.data;
                        layer.msg('选中了：'+ data.length + ' 个');
                        break;
                    case 'isAll':
                        layer.msg(checkStatus.isAll ? '全选': '未全选');
                        break;
                };
            });

            //监听行工具事件
            table.on('tool(test)', function(obj){
                var data = obj.data;
                //console.log(obj)
                if(obj.event === 'del'){
                    layer.confirm('真的删除行么', function(index){
                        obj.del();
                        layer.close(index);
                    });
                } else if(obj.event === 'edit'){
                    layer.prompt({
                        formType: 2
                        ,value: data.email
                    }, function(value, index){
                        obj.update({
                            email: value
                        });
                        layer.close(index);
                    });
                }
            });
        });

        //轮播图
        layui.use('carousel', function(){
            var carousel = layui.carousel;
            //建造实例
            carousel.render({
                elem: '#slider_img'
                ,width: '100%' //设置容器宽度
                ,arrow: 'always' //始终显示箭头
                // ,anim: 'updown' //切换动画方式
                ,height:'450px'
            });
        });

        layui.use('laydate', function(){
            var laydate = layui.laydate;
            //查看预定的左边日历
            laydate.render({
                elem: '#calender1' //指定元素
                // ,show: true //直接显示
                ,position: 'static'
                ,calendar: true
                // ,change: function(value, date){ //监听日期被切换
                //     alert(value+date);
                // }
                ,done: function(value, date, endDate){
                    console.log(value); //得到日期生成的值，如：2017-08-18
                    // console.log(date); //得到日期时间对象：{year: 2017, month: 8, date: 18, hours: 0, minutes: 0, seconds: 0}
                    // console.log(endDate); //得结束的日期时间对象，开启范围选择（range: true）才会返回。对象成员同上。
                }
            });

        //    弹出框日期选择
            layui.use('laydate', function(){
                var laydate = layui.laydate;

                laydate.render({
                    elem: '#day' //指定元素
                    ,calendar: true
                });
            });
        });

        //发起预定弹出框的js
        layui.use('layer', function(){ //独立版的layer无需执行这一句
            var $ = layui.jquery, layer = layui.layer; //独立版的layer无需执行这一句

            //触发事件
            var active = {
                notice: function(){
                    //示范一个公告层
                    layer.open({
                        type: 1
                        ,title: false //不显示标题栏
                        ,closeBtn: false
                        ,area: '300px;'
                        ,shade: 0.8
                        ,id: 'LAY_layuipro' //设定一个id，防止重复弹出
                        ,btn: ['火速围观', '残忍拒绝']
                        ,btnAlign: 'c'
                        ,moveType: 1 //拖拽模式，0或者1
                        ,content: '<div style="padding: 50px; line-height: 22px; background-color: #393D49; color: #fff; font-weight: 300;">你知道吗？亲！<br>layer ≠ layui<br><br>layer只是作为Layui的一个弹层模块，由于其用户基数较大，所以常常会有人以为layui是layerui<br><br>layer虽然已被 Layui 收编为内置的弹层模块，但仍然会作为一个独立组件全力维护、升级。<br><br>我们此后的征途是星辰大海 ^_^</div>'
                        ,success: function(layero){
                            var btn = layero.find('.layui-layer-btn');
                            btn.find('.layui-layer-btn0').attr({
                                href: 'http://www.layui.com/'
                                ,target: '_blank'
                            });
                        }
                    });
                }
            };

            $('.open').on('click', function(){
                var othis = $(this), method = othis.data('method');
                active[method] ? active[method].call(this, othis) : '';
            });
        });

        layui.use('form', function(){
            var form = layui.form;

            //监听提交
            form.on('submit(formDemo)', function(data){
                layer.msg(JSON.stringify(data.field));
                return false;
            });
            form.on('select(com)', function(data){
                // console.log(data.elem); //得到select原始DOM对象
                // console.log(data.value); //得到被选中的值
                // console.log(data.othis); //得到美化后的DOM对象
                var city = $('#sections');

                $.ajax({url:"http://localhost:63342/服务外包/meet/1.json",success:function(result){
                        // console.log(vm.sections);
                        vm.sections = result.data;
                        // console.log(vm.sections)
                        vm.$forceUpdate();
                        // console.log(result);
                        // console.log(vm.sections);
                        for(var i=0; i<vm.sections.length; i++) {
                            console.log(i);
                            city.append("<option>" + vm.sections[i].city + "</option>");
                        }
                        form.render('select');
                    }});

            });
        });

        var vm = new Vue({
            el: '#add_apply',
            data: {
                companys: [

                ],
                sections: [

                ],
                company: null,
                section: null
            },
            methods: {
                // change(k){
                //     console.log(k);
                //     $$.ajax({url:"http://localhost:63342/服务外包/meet/1.json",success:function(result){
                //         vm.sections = result.data;
                //         console.log(vm.sections);
                //         // console.log(vm.companys);
                //             vm.$forceUpdate();
                //     }});
                // }
            },
            created(){
                $.ajax({url:"http://localhost:63342/服务外包/meet/1.json",success:function(result){
                        vm.companys = result.data;
                        // console.log(result);
                        // console.log(vm.companys);
                    }});
            }
        })
    </script>
</body>
</html>